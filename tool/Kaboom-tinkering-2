<!DOCTYPE html>
<html>
<head>
  <script src="https://unpkg.com/kaboom@3000.0.1/dist/kaboom.js"></script>
</head>
<body>
<script>
kaboom({
  background: [30, 30, 40],
});

// Load sprite
loadSprite("bean", "https://kaboomjs.com/sprites/bean.png");

// When assets are loaded
onLoad(() => {

  // Add the player
  const player = add([
    sprite("bean"),
    pos(150, 80),
    area(),
    body(),
    color(255, 0, 0),
    "bean"
  ]);

  const SPEED = 200;

  // Movement controls
  onKeyDown("left",  () => player.move(-SPEED, 0));
  onKeyDown("right", () => player.move(SPEED, 0));
  onKeyDown("up",    () => player.move(0, -SPEED));
  onKeyDown("down",  () => player.move(0, SPEED));

  // Explosion effect when clicked
  player.onClick(() => {
    explode(player.pos);
    destroy(player);
  });
});

// Function to make explosion
function explode(origin) {
  const numParticles = 12;
  const radius = 8;

  for (let i = 0; i < numParticles; i++) {
    const angle = (2 * Math.PI * i) / numParticles;
    const dir = vec2(Math.cos(angle), Math.sin(angle));

    add([
      pos(origin),
      circle(radius),
      color(255, rand(100, 255), 0),
      move(dir, rand(150, 300)),
      lifespan(1, { fade: 0.5 }),
    ]);
  }
}
</script>
</body>
</html>
